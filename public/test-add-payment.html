// Test Add Payment functionality
const testAddPayment = async () => {
  console.log('ğŸ§ª Testing Add Payment Database Integration...');
  
  try {
    // Test the API endpoint directly
    const response = await fetch('http://localhost:3001/api/patients/patient-payments', {
      method: 'GET',
      headers: {
        'Content-Type': 'application/json'
      }
    });
    
    if (response.ok) {
      const payments = await response.json();
      console.log('âœ… Database connection successful!');
      console.log(`ğŸ“Š Found ${payments.length} existing payment records:`);
      payments.slice(0, 5).forEach((payment, index) => {
        console.log(`${index + 1}. Patient ID: ${payment.patientId}, Amount: â‚¹${payment.amount}, Date: ${payment.date}, Mode: ${payment.paymentMode}`);
      });
      
      if (payments.length > 5) {
        console.log(`... and ${payments.length - 5} more records`);
      }
    } else {
      console.error('âŒ Database connection failed:', response.status, response.statusText);
    }
  } catch (error) {
    console.error('âŒ Error testing payment API:', error.message);
  }

  // Test adding a new payment
  console.log('\nğŸ§ª Testing Add Payment functionality...');
  try {
    const testPayment = {
      patientId: 'P0001', // Use existing patient ID
      date: '2025-08-17',
      amount: 500,
      comment: 'Test payment from Add Payment form',
      paymentMode: 'Cash',
      balanceRemaining: 0,
      createdBy: 'Test User',
      createdAt: new Date().toISOString()
    };

    const response = await fetch('http://localhost:3001/api/patients/patient-payments', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(testPayment)
    });

    if (response.ok) {
      const result = await response.json();
      console.log('âœ… Payment added successfully!');
      console.log('ğŸ’° New payment record:', result);
    } else {
      const error = await response.json();
      console.error('âŒ Failed to add payment:', error);
    }
  } catch (error) {
    console.error('âŒ Error adding payment:', error.message);
  }
};

// Run the test
testAddPayment();
